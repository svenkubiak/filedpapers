function openModal(e){e.classList.add("is-active"),"add-category-modal"===e.id&&setTimeout(()=>{document.getElementById("category").focus()},100)}function closeModal(e){e.classList.remove("is-active")}function closeAllModals(){document.querySelectorAll(".modal").forEach(e=>{closeModal(e)})}const $addButton=document.getElementById("add-category-button"),$addBookmark=document.getElementById("add-bookmark-modal"),$modal=document.getElementById("add-category-modal"),$deleteModal=document.getElementById("delete-confirm-modal"),$deleteCategoryModal=document.getElementById("delete-category-confirm-modal"),$emptyTrashModal=document.getElementById("empty-trash-confirm-modal");$addButton.addEventListener("click",()=>{openModal($modal)});const $closeButtons=document.querySelectorAll(".modal-background, .modal-card-head .delete, .modal-card-foot .button:not(.is-danger)");$closeButtons.forEach(e=>{e.addEventListener("click",()=>{closeAllModals()})}),document.addEventListener("keydown",e=>{"Escape"===e.code&&closeAllModals()});const draggableItems=document.querySelectorAll('.foo[draggable="true"]'),categoryTargets=document.querySelectorAll(".menu-list a[data-category]");let $cardToDelete=null;draggableItems.forEach(e=>{e.addEventListener("dragstart",t=>{let a=document.createElement("div");a.className="drag-icon",a.innerHTML='<i class="fas fa-bookmark fa-2x"></i>',a.style.position="absolute",a.style.top="-1000px",a.style.color="#3273dc",document.body.appendChild(a),t.dataTransfer.setDragImage(a,25,25),e.closest(".card").classList.add("dragging"),t.dataTransfer.setData("text/plain",e.dataset.uid),setTimeout(()=>{document.body.removeChild(a)},0)}),e.addEventListener("dragend",()=>{e.closest(".card").classList.remove("dragging")})}),categoryTargets.forEach(e=>{e.addEventListener("dragover",t=>{t.preventDefault(),e.classList.add("drag-over")}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",async t=>{t.preventDefault(),e.classList.remove("drag-over");let a=t.dataTransfer.getData("text/plain"),o=e.dataset.uid,s=await fetch("/api/v1/items",{method:"PUT",body:JSON.stringify({uid:a,category:o}),headers:{"Content-type":"application/json"}});s.ok?sessionStorage.setItem("toast-success","Bookmark successfully moved!"):sessionStorage.setItem("toast-error","Ops, something went wrong. Please try again."),closeAllModals(),window.location.href="/dashboard"})}),document.querySelectorAll(".card-trash").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),$cardToDelete=e.currentTarget.closest(".card"),openModal($deleteModal)})}),document.querySelectorAll(".category-trash").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),$categoryToDelete=e.currentTarget,openModal($deleteCategoryModal)})}),document.querySelectorAll(".empty-trash").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),openModal($emptyTrashModal)})}),document.getElementById("confirm-category-delete").addEventListener("click",async()=>{if($categoryToDelete){let e=$categoryToDelete.dataset.uid,t=await fetch("/api/v1/categories/"+e,{method:"DELETE",headers:{"Content-type":"application/json"}});t.ok?sessionStorage.setItem("toast-success","Category successfully deleted!"):sessionStorage.setItem("toast-error","Ops, something went wrong. Please try again."),closeAllModals(),window.location.href="/dashboard"}closeModal($deleteCategoryModal)}),document.getElementById("confirm-empty-trash").addEventListener("click",async()=>{let e=await fetch("/api/v1/items/trash",{method:"DELETE",headers:{"Content-type":"application/json"}});e.ok?sessionStorage.setItem("toast-success","Trash successfully emptied!"):sessionStorage.setItem("toast-error","Ops, something went wrong. Please try again."),closeAllModals(),window.location.href="/dashboard"}),document.getElementById("confirm-delete").addEventListener("click",async()=>{if($cardToDelete){$cardToDelete.style.transition="all 0.3s ease",$cardToDelete.style.opacity="0",setTimeout(()=>{$cardToDelete.closest(".column").remove()},300);let e=$cardToDelete.dataset.uid,t=$cardToDelete.dataset.category,a=await fetch("/api/v1/items/"+e,{method:"PUT",headers:{"Content-type":"application/json"}});a.ok?sessionStorage.setItem("toast-success","Bookmark successfully deleted!"):sessionStorage.setItem("toast-error","Ops, something went wrong. Please try again."),closeAllModals(),window.location.href="/dashboard/"+t}});const $addBookmarkSubmit=document.getElementById("add-category-submit");$addBookmarkSubmit&&$addBookmarkSubmit.addEventListener("click",async e=>{e.preventDefault();let t=document.getElementById("category").value;if(t){let a=await fetch("/api/v1/categories",{method:"POST",body:JSON.stringify({name:t}),headers:{"Content-type":"application/json"}});a.ok?sessionStorage.setItem("toast-success","Category successfully created!"):sessionStorage.setItem("toast-error","Ops, something went wrong. Please try again."),document.getElementById("category").value="",closeAllModals(),window.location.href="/dashboard"}else document.getElementById("category").classList.add("is-danger")});const $bookmarkUrl=document.getElementById("bookmark-url");function showToast(e,t="success",a=3e3){let o=document.querySelector(".toast-container"),s=document.createElement("div");s.className=`toast ${"error"===t?"is-danger":""}`,s.innerHTML=`
            <span class="icon">
                <i class="fas ${"error"===t?"fa-exclamation-circle":"fa-check-circle"}"></i>
            </span>
            <span>${e}</span>
        `,o.appendChild(s),s.offsetHeight,requestAnimationFrame(()=>{s.classList.add("is-active")}),setTimeout(()=>{s.classList.remove("is-active"),setTimeout(()=>{o.removeChild(s)},300)},a)}function showLoading(){let e=document.getElementById("loading-button");e&&(e.classList.add("is-loading"),e.disabled=!0);let t=document.getElementById("loading-button2");t&&(t.classList.add("is-loading"),t.disabled=!0)}$bookmarkUrl&&$bookmarkUrl.addEventListener("input",()=>{$bookmarkUrl.classList.remove("is-danger")}),window.addEventListener("load",()=>{let e=sessionStorage.getItem("toast-success");e&&(showToast(e),sessionStorage.setItem("toast-success",""));let t=sessionStorage.getItem("toast-error");t&&(showToast(t,"error"),sessionStorage.setItem("toast-error",""))});const fabButton=document.getElementById("fab-add-bookmark");fabButton&&fabButton.addEventListener("click",()=>{openModal($addBookmark)});const $confirmAddBookmark=document.getElementById("confirm-add-bookmark");$confirmAddBookmark&&$confirmAddBookmark.addEventListener("click",async e=>{e.preventDefault();let t=document.getElementById("bookmark-url").value,a=document.getElementById("bookmark-category").value;if(t&&a){$confirmAddBookmark.classList.add("is-loading"),$confirmAddBookmark.disabled=!0;let o=await fetch("/api/v1/items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t,category:a.toLowerCase()})});o.ok?sessionStorage.setItem("toast-success","Bookmark successfully created!"):sessionStorage.setItem("toast-error","Ops, something went wrong. Please try again."),closeAllModals(),window.location.href="/dashboard/"+a,$addBookmarkSubmit.classList.remove("is-loading"),$addBookmarkSubmit.disabled=!1}}),document.querySelectorAll(".image-container").forEach(e=>{let t=e.querySelector(".image-with-fallback"),a=e.querySelector(".spinner"),o=!1,s=()=>{a.style.display="none",t.style.display="block"},l=()=>{o||(o=!0,s())},r=()=>{o||(o=!0,a.style.display="none",t.style.display="block",t.src="/assets/images/placeholder.svg")};t.onload=l,t.onerror=r,t.complete?t.naturalWidth>0?l():r():setTimeout(()=>{o||r()},4e3)});